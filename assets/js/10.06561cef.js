(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{207:function(t,n,e){"use strict";e.r(n);var a=e(28),o=Object(a.a)({},(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"移动端-h5-中百度地图的点击事件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#移动端-h5-中百度地图的点击事件"}},[t._v("#")]),t._v(" 移动端 H5 中百度地图的点击事件")]),t._v(" "),e("p",[t._v("根据百度地图官方解释，在移动端 H5 页面中可监听下面这 4 个事件:")]),t._v(" "),e("p",[e("strong",[t._v("touchstart, touchmove, touchend, longpress")])]),t._v(" "),e("p",[e("img",{attrs:{src:"/event.jpeg",alt:"图片描述"}})]),t._v(" "),e("p",[t._v("而如果地图上监听了 "),e("strong",[t._v("click")]),t._v(" 事件，在移动端是"),e("strong",[t._v("不会执行")]),t._v("这个事件里面的代码的。")]),t._v(" "),e("p",[t._v("我之前做一个需求时，给地图监听了 touchend 事件，不曾想当我拖动地图时，也执行了 touchend 里的代码。所以需要模拟一个像 zepto 中的 tap 事件，就能解决这个问题了。")]),t._v(" "),e("p",[t._v("我的代码是：")]),t._v(" "),e("div",{staticClass:"language-(js) extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("function initMap(baseData) {\n    var mp = new BMap.Map('map');\n    var point = new BMap.Point(\n      baseData.data.gardenLongitude,\n      baseData.data.gardenLatitude\n    );\n\n    mp.centerAndZoom(point, 15);\n\n    // 保存 touch 对象信息\n    var obj = {};\n\n    mp.addEventListener('touchstart', function (e) {\n      obj.e = e.changedTouches ? e.changedTouches[0] : e;\n      obj.target = e.target;\n      obj.time = Date.now();\n      obj.X = obj.e.pageX;\n      obj.Y = obj.e.pageY;\n    });\n\n    mp.addEventListener('touchend', function (e) {\n      obj.e = e.changedTouches ? e.changedTouches[0] : e;\n      if (\n        obj.target === e.target &&\n\n        // 大于 750 可看成长按了\n        ((Date.now() - obj.time) < 750) &&\n\n        // 应用勾股定理判断，如果 touchstart 的点到 touchend 的点小于 15，就可当成地图被点击了\n        (Math.sqrt(Math.pow(obj.X - obj.e.pageX, 2) + Math.pow(obj.Y - obj.e.pageY, 2)) < 15)\n      ) {\n        // 地图被点击了，执行一些操作\n        doSomething();\n      }\n    });\n  }\n")])])])])}),[],!1,null,null,null);n.default=o.exports}}]);