(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{215:function(n,t,e){"use strict";e.r(t);var a=e(28),r=Object(a.a)({},(function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"vue-set-原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vue-set-原理"}},[n._v("#")]),n._v(" vue.$set()原理")]),n._v(" "),e("p",[n._v("首先上一个思维导图便于理解：")]),n._v(" "),e("p",[e("img",{attrs:{src:"/$set.png",alt:"vue.$set().png"}})]),n._v(" "),e("p",[n._v("下面是原代码，其实原代码很简单易懂的（来自网络）：")]),n._v(" "),e("div",{staticClass:"language-(js) extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("function set(target: Array<any> | Object, key: any, val: any): any {\n  // isUndef 是判断 target 是不是等于 undefined 或者 null 。\n  //isPrimitive 是判断 target 的数据类型是不是 string、number、symbol、boolean 中的一种\n  if (process.env.NODE_ENV !== 'production' &&\n    (isUndef(target) || isPrimitive(target))\n  ) {\n    warn(`Cannot set reactive property on undefined, null, or primitive value: ${(target: any)}`)\n  }\n\n  // 数组的处理\n  if (Array.isArray(target) && isValidArrayIndex(key)) {\n    target.length = Math.max(target.length, key)\n    target.splice(key, 1, val)\n    return val\n  }\n\n  // 对象，并且该属性原来已存在于对象中，则直接更新\n  if (key in target && !(key in Object.prototype)) {\n    target[key] = val\n    return val\n  }\n\n  // vue给响应式对象(比如 data 里定义的对象)都加了一个 __ob__ 属性，\n  // 如果一个对象有这个 __ob__ 属性，那么就说明这个对象是响应式对象，我们修改对象已有属性的时候就会触发页面渲染。\n  // 非 data 里定义的就不是响应式对象。\n  const ob = (target: any).__ob__\n\n  if (target._isVue || (ob && ob.vmCount)) {\n    process.env.NODE_ENV !== 'production' && warn(\n      'Avoid adding reactive properties to a Vue instance or its root $data ' +\n      'at runtime - declare it upfront in the data option.'\n    )\n    return val\n  }\n\n  // 不是响应式对象\n  if (!ob) {\n    target[key] = val\n    return val\n  }\n\n  // 是响应式对象，进行依赖收集\n  defineReactive(ob.value, key, val)\n\n  // 触发更新视图\n  ob.dep.notify()\n  return val\n}\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);